+++
# --- Basic Metadata ---
id = "WF-CONTEXT7-ENRICHMENT-001"
title = "Workflow: Context7 KB Enrichment (v1.5)" # Updated version
status = "draft"
created_date = "2025-04-27"
updated_date = "2025-04-27" # Use today's date
version = "1.8" # Incremented version
tags = [
    "workflow", "kb-enrichment", "context7", "script-integration", "modes", "pipeline",
    "documentation", "sop", "context-handling", "json-context", "subfolders",
    "existing-mode", "url", "summary-rule", "source-info", "metadata", "scraping", # Added tags
    "mcp-usage"
]

# --- Ownership & Context ---
owner = "Roo Commander"
related_docs = [
    ".ruru/workflows/WF-MODE-KB-ENRICHMENT-002.md", # General enrichment workflow
    "process_llms_json.js", # The script used
    ".roo/rules/01-standard-toml-md-format.md",
    ".roo/rules/04-mdtm-workflow-initiation.md",
    ".roo/rules/08-logging-procedure-simplified.md",
    ".roo/rules/10-vertex-mcp-usage-guideline.md", # Added MCP usage rule
    ".ruru/processes/acqa-process.md",
    ".ruru/processes/afr-process.md",
    ".ruru/processes/pal-process.md",
    ".ruru/planning/enhance_context7_source_info.md" # Added planning doc reference
]
related_templates = []

# --- Workflow Specific Fields ---
objective = "Define the step-by-step procedure for enriching an *existing* specialist mode's KB using AI-processed context derived *specifically* from a Context7 base URL via the `process_llms_json.js` script. This includes fetching source metadata, storing source information (URL, derived `llms.json` URL, and fetched metadata) in `source_info.json`, and generating a summary rule file." # Updated objective
scope = "Covers the end-to-end process for enriching an *existing* mode's KB using a Context7 URL. It includes gathering the target mode slug and base URL, executing the `process_llms_json.js` script, fetching source metadata (via MCPs or manually), storing the source information and metadata in `kb/context7/source_info.json`, generating a Context7 summary rule, verifying the generated KB index (`kb/context7/_index.json`), updating the KB README, ensuring the KB usage strategy document exists, updating the mode definition file, performing QA, facilitating user review, and cleanup." # Updated scope
roles = [
    "User", "Coordinator (Roo Commander)",
    "Mode Structure Agent (e.g., mode-maintainer, technical-writer)",
    "Specialist Agent (e.g., agent-context-condenser, technical-writer)", # For summary rule
    "File Editor Agent (e.g., prime-dev, prime-txt)", # For source_info.json
    "Research/Scraping Agent (Potentially Coordinator using MCPs)", # For metadata fetching
    "QA Agent (e.g., code-reviewer)"
]
trigger = "Manual initiation by Roo Commander or User for a specific Context7 base URL and target *existing* mode."
success_criteria = [
    "Target mode's KB contains processed context files in the `kb/context7/` subdirectory.",
    "Target mode's KB includes a valid `kb/context7/_index.json` file generated by the script.",
    "Target mode's KB includes a `kb/context7/source_info.json` file containing `baseUrl`, `llmsJsonUrl`, and potentially `originalSourceUrl` and a `metadata` object (with `tokens`, `snippets`, `lastUpdated`).", # Updated criteria
    "A summary rule file exists at `.roo/rules-[mode_slug]/05-context7-summary.md` (or similar prefix) listing the KB topics.",
    "Target mode's KB README (`kb/README.md`) is updated referencing the `context7` directory and its `_index.json`.",
    "Target mode has an internal KB usage strategy document (`kb/00-kb-usage-strategy.md`).",
    "Target mode's configuration (`.mode.md`) references `kb/context7/_index.json` in `related_context`.",
    "The enriched structure passes Quality Assurance (QA) review.",
    "User confirms the enrichment meets initial requirements."
]
failure_criteria = [
    "Failure to get valid target mode or Context7 base URL.",
    "Failure executing the `process_llms_json.js` script.",
    "Failure fetching source metadata (Step 2).", # Renumbered criteria
    "Failure storing the source info and metadata in `source_info.json` (Step 4).", # Criteria & step number ok
    "Failure generating the Context7 summary rule (Step 5).", # Step number ok
    "Failure during KB README or mode definition updates (Steps 7, 8).", # Step numbers ok
    "Failure to ensure usage strategy document exists (Step 6).", # Step number ok
    "Generated `_index.json` or content fails validation/QA checks.",
    "User rejects the final enrichment."
]

# --- Integration ---
acqa_applicable = true # Requires ACQA review
pal_validated = false
validation_notes = ""

# --- AI Interaction Hints (Optional) ---
context_type = "workflow_definition"
+++

# Workflow: Context7 KB Enrichment (v1.5)

## 1. Objective ðŸŽ¯

To define the step-by-step procedure for enriching an **existing** specialist mode's KB using AI-processed context derived **specifically** from a Context7 base URL via the `process_llms_json.js` script. This includes fetching source metadata, storing source information (URL, derived `llms.json` URL, and fetched metadata) in `source_info.json`, and generating a summary rule file.

## 2. Scope â†”ï¸

This workflow covers the end-to-end process for enriching an **existing** mode's KB using a Context7 URL. It includes gathering the target mode slug and base URL, executing the `process_llms_json.js` script, fetching source metadata (via MCPs or manually), storing the source information and metadata in `kb/context7/source_info.json`, generating a Context7 summary rule, verifying the generated KB index (`kb/context7/_index.json`), updating the KB README, ensuring the KB usage strategy document exists, updating the mode definition file, performing QA, facilitating user review, and cleanup.

## 3. Roles & Responsibilities ðŸ‘¤

*   **User:** Initiates or confirms the request, provides target mode slug and Context7 base URL, provides manual metadata if needed, and confirms final enrichment.
*   **Coordinator (Roo Commander):** Orchestrates the workflow, interacts with the User, delegates tasks, performs QA, attempts metadata fetching via MCPs, and manages finalization steps.
*   **Mode Structure Agent:** (Worker Agent, e.g., `mode-maintainer`, `technical-writer`) Updates README, usage strategy, and mode definition file, preferring MCP tools.
*   **Specialist Agent:** (Worker Agent, e.g., `agent-context-condenser`, `technical-writer`) Scans KB directory and generates the Context7 summary rule file.
*   **File Editor Agent:** (Worker Agent, e.g., `prime-dev`, `prime-txt`) Creates/updates the `source_info.json` file.
*   **Research/Scraping Agent:** (Implicit role, potentially Coordinator using MCPs like Vertex AI or Firecrawl) Fetches metadata.
*   **QA Agent:** (Worker Agent, potentially Coordinator) Reviews generated artifacts against standards and requirements (part of ACQA process).

## 4. PreconditionsðŸš¦

*   The target specialist mode (`[mode_slug]`) exists.
*   The user can provide a valid Context7 base URL.
*   The `process_llms_json.js` script exists in the workspace root and is functional (using `process.argv` for args).
*   Network access is available for the script to fetch the `llms.json` file and for MCPs to fetch metadata.
*   Required agents (`mode-maintainer`, `agent-context-condenser`, `prime-dev`, etc.) are operational.
*   Relevant MCP servers (for file operations, Vertex AI, potentially scraping) are connected (preferred).
*   The User is available for interaction.

## 5. Reference Documents & Tools ðŸ“šðŸ› ï¸

*   Processing Script: `process_llms_json.js`
*   General Enrichment Workflow: `.ruru/workflows/WF-MODE-KB-ENRICHMENT-002.md`
*   Source Info Structure: `.ruru/planning/enhance_context7_source_info.md`
*   Relevant Rules: `.roo/rules/`, `.roo/rules-[mode_slug]/` (TOML format, Logging, MCP Usage, etc.)
*   Relevant Processes: ACQA, AFR, PAL
*   **MCP Tools (Preferred):**
    *   Metadata Fetching: `use_mcp_tool` (e.g., `vertex-ai-mcp-server.answer_query_websearch`, `firecrawl-mcp-server.scrape_url`)
    *   File Operations: `write_file_content`, `create_directory`, `list_directory_contents`, `read_file_content`, `edit_file_content`, `get_filesystem_info`, `search_filesystem`
*   **Fallback Tools:**
    *   Metadata Fetching: `ask_followup_question`
    *   File Operations: `write_to_file`, `execute_command` (`mkdir`, `rm`), `list_files`, `read_file`, `apply_diff`, `insert_content`, `search_files`

## 6. Workflow Steps ðŸªœ

*(Coordinator: `roo-commander` unless otherwise specified)*

*   **Step 1: Initiation & Requirements Gathering (Coordinator, User)**
    *   **1.1:** Coordinator asks User for an approximate name or part of the slug for the target mode. Store as `[approx_mode_name]`.
    *   **1.2:** Coordinator uses `list_files` on `.ruru/modes/` (non-recursive) to get a list of all mode slugs.
    *   **1.3:** Coordinator filters the list based on `[approx_mode_name]`.
    *   **1.4:** If exactly one match, propose for confirmation. If multiple, present options via `ask_followup_question`. If none, ask for different name. Store confirmed slug as `[mode_slug]`. Handle errors/cancellation.
    *   **1.5:** Ask User for the **Context7 base URL** (e.g., `https://context7.com/library/docs`). Store as `[context7_base_url]`. Validate basic URL format. Handle errors.
    *   **1.6:** Coordinator summarizes confirmed `[mode_slug]` and `[context7_base_url]`. Ask User for confirmation to proceed.

*   **Step 2: Fetch Source Metadata (Coordinator)** # Moved Up, Renumbered
    *   **2.1:** Coordinator attempts to fetch metadata (`originalSourceUrl`, `tokens`, `snippets`, `lastUpdated`) associated with `[context7_base_url]`. Store results in temporary variables (e.g., `[fetched_original_url]`, `[fetched_tokens]`, etc.). Prioritize methods:
        *   **Attempt 1 (MCP Tools - Vertex AI / Scraper):**
            *   Check for connected MCPs suitable for web scraping/information extraction (e.g., `vertex-ai-mcp-server`, `firecrawl-mcp-server`).
            *   If `vertex-ai-mcp-server` and `answer_query_websearch` are available:
                *   Formulate a query like: "Extract the original source URL, estimated token count, estimated snippet count, and last updated date for the documentation hosted at [context7_base_url]".
                *   Use `use_mcp_tool` (`vertex-ai-mcp-server`, `answer_query_websearch`). Parse response. Log success/failure. If successful, proceed to 2.2.
            *   If Vertex AI failed or is unavailable, and another scraper (e.g., `firecrawl-mcp-server` with `scrape_url`) is available:
                *   Use `use_mcp_tool` to scrape `[context7_base_url]`, requesting metadata extraction if possible. Parse response. Log success/failure. If successful, proceed to 2.2.
        *   **Attempt 2 (Manual Input):**
            *   If automated attempts fail, use `ask_followup_question` to ask the User: "Could not automatically fetch metadata for [context7_base_url]. Please provide the following if known (leave blank if unknown), or type 'skip' to proceed with default token count (10,000,000) and no other metadata: Original Source URL, Estimated Token Count, Estimated Snippet Count, Last Updated Date (YYYY-MM-DD)".
            *   Store the user's input. Log the manual input received. Check if user typed 'skip'.
    *   **2.2:** Determine final metadata values:
        *   If any automated attempt (2.1) or manual input (2.2, not 'skip') provided values, use them. Store the token count (or null if not provided) in `[fetched_tokens]`. Log the outcome (method succeeded, data obtained).
        *   If all attempts failed OR the user chose 'skip':
            *   Set `[fetched_tokens] = 10000000`.
            *   Set `[fetched_original_url] = null`.
            *   Set `[fetched_snippets] = null`.
            *   Set `[fetched_last_updated] = null`.
            *   Log that fallback logic was used (default tokens, skipped other metadata).

*   **Step 3: Execute Processing Script (Coordinator)** # Renumbered, Command Updated
    *   **3.1:** Define `[context7_output_dir] = .ruru/modes/[mode_slug]/kb/context7`.
    *   **3.2:** Construct the command string. Include `--tokens` argument. Use fetched value if available, otherwise use fallback.
        *   `cmd = "node process_llms_json.js --baseUrl \"[context7_base_url]\" --outputDir \"[context7_output_dir]\""`
        *   If `[fetched_tokens]` has a value: `cmd += " --tokens \"[fetched_tokens]\""`
        *   Else: `cmd += " --tokens \"10000000\""` # Fallback value
        *   *(Coordinator Note: Using fetched token count if available from Step 2, otherwise defaulting to 10,000,000 as determined in Step 2's fallback logic.)*
    *   **3.3:** Use `execute_command` to run the constructed command `cmd`.
    *   **3.4:** Explain the command (including the token argument source/fallback) to the user.
    *   **3.5:** Check the command's exit code. If non-zero, log the error and output, inform the user, and **Stop** the workflow.
    *   **3.6:** Log successful execution of the script and generation of `kb/context7/_index.json`.

*   **Step 4: Store Source Info & Metadata (Coordinator delegates to File Editor Agent)** # Renumbered, Updated Reference
    *   **4.1:** Coordinator determines the appropriate agent (e.g., `prime-dev`, `prime-txt`) for creating/updating the JSON file.
    *   **4.2:** Coordinator delegates the task via MDTM or `new_task` with the following instructions:
        *   Define `[source_info_path] = .ruru/modes/[mode_slug]/kb/context7/source_info.json`.
        *   Construct `[llms_json_url] = [context7_base_url]/llms.json`.
        *   Retrieve the fetched/provided metadata from Step 2 (e.g., `[fetched_original_url]`, `[fetched_tokens]`, `[fetched_snippets]`, `[fetched_last_updated]`). Handle cases where values might be null or empty if fetching/input failed.
        *   Prepare JSON content according to the structure in `.ruru/planning/enhance_context7_source_info.md`:
            ```json
            {
              "baseUrl": "[context7_base_url]",
              "llmsJsonUrl": "[llms_json_url]",
              "originalSourceUrl": "[fetched_original_url or null]", // Include if available
              "metadata": {
                "tokens": [fetched_tokens or null], // Include if available, ensure numeric or null
                "snippets": [fetched_snippets or null], // Include if available, ensure numeric or null
                "lastUpdated": "[fetched_last_updated or null]" // Include if available, ensure YYYY-MM-DD format or null
              }
            }
            ```
            *(Agent Note: Ensure the final JSON is valid. Convert token/snippet counts to numbers if provided as strings, otherwise use null. Validate date format if provided. Ensure metadata fields are `null` if fetching/input failed or was skipped in Step 2, except for `tokens` which will have the determined value (fetched or default).)*
        *   Use file writing tools (Prefer MCP `write_file_content`, fallback `write_to_file`) to create/overwrite `[source_info_path]` with the JSON content. Ensure the directory `.ruru/modes/[mode_slug]/kb/context7/` exists (created by Step 3.2).
        *   Log any errors during file writing.
        *   Report completion or failure back to the Coordinator.
    *   **4.3:** Coordinator handles delegate errors (Log, potentially **Stop**).

*   **Step 5: Generate Context7 Summary Rule (Coordinator delegates to Specialist Agent)** # Renumbered
    *   **5.1:** Coordinator determines the appropriate specialist (e.g., `agent-context-condenser`, `technical-writer`) for generating the summary rule.
    *   **5.2:** Coordinator delegates the task via MDTM or `new_task` with the following instructions:
        *   Define `[context7_kb_dir] = .ruru/modes/[mode_slug]/kb/context7`.
        *   Define `[summary_rule_path] = .roo/rules-[mode_slug]/05-context7-summary.md`. (Note: Check if `05` prefix is available, adjust if necessary, e.g., `06`, `07`...).
        *   Recursively scan `[context7_kb_dir]` to find all files named `_index.json` (Prefer MCP `search_filesystem`, fallback `search_files` or `list_files` recursive + filter).
        *   Prepare the content for `[summary_rule_path]`:
            *   **TOML Frontmatter:**
                ```toml
                +++
                id = "RULE-[MODE_SLUG]-CONTEXT7-SUMMARY-V1" # Generate unique ID
                title = "Context7 KB Scope Summary ([mode_slug])"
                context_type = "rules"
                scope = "summary"
                status = "active"
                last_updated = "2025-04-27" # Use current date
                tags = ["rules", "summary", "context7", "kb", "[mode_slug]"]
                related_context = [".ruru/modes/[mode_slug]/kb/context7/_index.json", ".ruru/modes/[mode_slug]/kb/context7/source_info.json"] # Ensure source_info is linked
                template_schema_doc = ".ruru/templates/toml-md/16_ai_rule.README.md"
                relevance = "Provides a quick overview of the topics covered in the Context7 KB."
                +++
                ```
            *   **Markdown Body:**
                ```markdown
                # Context7 Knowledge Base Summary for `[mode_slug]`

                This rule provides a summary of the main topics found within the Context7-derived Knowledge Base located at `.ruru/modes/[mode_slug]/kb/context7/`. The source URLs and metadata are stored in `source_info.json` within the same directory.

                ## Main Topics

                *   [List each found `_index.json` file, deriving the topic name from its directory path relative to `kb/context7/`, and linking to the file path relative to the workspace root.]
                    *   Example: `- Core Concepts: .ruru/modes/[mode_slug]/kb/context7/core_concepts/_index.json`
                    *   Example: `- API Reference: .ruru/modes/[mode_slug]/kb/context7/api/_index.json`

                *Note: This summary is auto-generated based on the presence of `_index.json` files.*
                ```
        *   Use file writing tools (Prefer MCP `write_file_content`, fallback `write_to_file`) to create/overwrite `[summary_rule_path]` with the prepared content. Ensure the directory `.roo/rules-[mode_slug]/` exists (Prefer MCP `create_directory`, fallback `execute_command mkdir -p`).
        *   Log any errors encountered during scanning or writing.
        *   Report completion or failure back to the Coordinator.
    *   **5.3:** Coordinator handles delegate errors (Log, potentially **Stop**).

*   **Step 6: Update/Create KB Usage Strategy (Coordinator delegates to Mode Structure Agent)** # Renumbered
    *   **6.1:** Instruct Mode Structure Agent to:
        *   Define `[usage_strategy_path] = .ruru/modes/[mode_slug]/kb/00-kb-usage-strategy.md`.
        *   Check if `[usage_strategy_path]` exists (Prefer MCP `get_filesystem_info`, fallback `list_files`).
        *   If it does NOT exist: Create it using standard content (defined elsewhere or a template). (Prefer MCP `write_file_content`, fallback `write_to_file`). Handle errors (Log).
        *   If it exists: Log that it already exists.
    *   **6.2:** Handle delegate errors.

*   **Step 7: Update Mode Definition Context (Coordinator delegates to Mode Structure Agent)** # Renumbered
    *   **7.1:** Instruct Mode Structure Agent to:
        *   Define `[mode_file_path] = .ruru/modes/[mode_slug]/[mode_slug].mode.md`.
        *   Define `[context7_index_context_path] = kb/context7/_index.json`.
        *   Read `[mode_file_path]` (Prefer MCP `read_file_content`, fallback `read_file`). Handle errors (Log, **Stop**).
        *   Parse TOML frontmatter.
        *   Check if `[context7_index_context_path]` is already in the `related_context` array.
        *   If NOT present: Add it. Re-serialize TOML. Use `apply_diff` (or MCP `edit_file_content`) to update the TOML block in `[mode_file_path]`. Handle errors (Log, **Stop**).
        *   If present: Log that context already exists.
    *   **7.2:** Handle delegate errors.

*   **Step 8: Generate/Update KB README (Coordinator delegates to Mode Structure Agent)** # Renumbered
    *   **8.1:** Instruct Mode Structure Agent to create/update `.ruru/modes/[mode_slug]/kb/README.md`.
    *   **8.2:** Ensure README includes:
        *   Overview of the KB.
        *   List of KB subdirectories (e.g., `context7`, `local_docs`) and a brief description of their contents, linking to their respective `_index.json` files where applicable.
        *   A specific mention of the `context7` directory, linking to `context7/_index.json`.
    *   **8.3:** Use file writing tools (Prefer MCP `write_file_content`, fallback `write_to_file`). Handle errors (Log).

*   **Step 9: Quality Assurance (Coordinator applies ACQA)** # Renumbered
    *   **9.1:** Coordinator initiates ACQA process (`.ruru/processes/acqa-process.md`).
    *   **9.2:** Checks (potentially delegated to `QA Agent`):
        *   Presence and basic structure of files in `kb/context7/`.
        *   Validity and consistency of `kb/context7/_index.json`.
        *   Presence and validity of `kb/context7/source_info.json` containing `baseUrl`, `llmsJsonUrl`, and `metadata` (where `tokens` has a value, and others might be `null`). # Updated check
        *   Presence, validity, and correctness of the summary rule file (`.roo/rules-[mode_slug]/05-context7-summary.md`).
        *   Update status and correctness of `kb/README.md`.
        *   Presence of `kb/00-kb-usage-strategy.md`.
        *   Correct update of `related_context` in `.mode.md`.
    *   **9.3:** Handle issues via corrections (looping back) or AFR process.

*   **Step 10: User Review (Coordinator, User)** # Renumbered
    *   **10.1:** Coordinator presents summary of changes (new `context7` directory, generated `_index.json`, new/updated `source_info.json` with obtained or default metadata, new summary rule, updated README) to User.
    *   **10.2:** Ask User for feedback: "Does this Context7 KB enrichment for mode `[mode_slug]`, including the obtained/default metadata, meet your expectations?"
    *   **10.3:** Handle refinements by looping back to relevant steps if necessary, followed by QA.

*   **Step 11: Finalization (Coordinator)** # Renumbered
    *   **11.1:** Log successful completion of Context7 enrichment for `[mode_slug]` using URL `[context7_base_url]`, including metadata fetching, generation of the summary rule and `source_info.json`.
    *   **11.2:** Report success to the User/initiating process.

## 7. Postconditions âœ…

*   Processed context files exist in `.ruru/modes/[mode_slug]/kb/context7/`.
*   Valid `_index.json` exists at `.ruru/modes/[mode_slug]/kb/context7/_index.json`.
*   Valid `source_info.json` exists at `.ruru/modes/[mode_slug]/kb/context7/source_info.json` containing `baseUrl`, `llmsJsonUrl`, and `metadata` (where `tokens` has a value, and others might be `null`). # Updated postcondition
*   A summary rule file exists at `.roo/rules-[mode_slug]/05-context7-summary.md` (or similar prefix).
*   The mode's KB README `.ruru/modes/[mode_slug]/kb/README.md` references the `context7` directory and its `_index.json`.
*   The mode's usage strategy exists at `.ruru/modes/[mode_slug]/kb/00-kb-usage-strategy.md`.
*   The mode's definition file `.ruru/modes/[mode_slug]/[mode_slug].mode.md` has `kb/context7/_index.json` in `related_context`.

## 8. Error Handling & Escalation (Overall) âš ï¸

*   Log errors at each step. Use AFR process for persistent issues.
*   Failure getting inputs (Step 1) or executing script (Step 3) is critical -> **Stop**. # Updated Step number
*   Failure fetching metadata (Step 2) triggers fallback logic (default tokens, null others). If manual input also fails/is skipped, proceed with defaults -> Log and Continue. # Updated Step number
*   Failure storing source info (Step 4) may require manual intervention or **Stop**. # Step number ok
*   Failure generating summary rule (Step 5) may require manual intervention or **Stop**. # Step number ok
*   Failure in README or mode definition updates (Steps 7, 8) may require manual intervention or **Stop**. # Step numbers ok
*   QA failures (Step 9) trigger correction loops or AFR. # Step number ok
*   User rejection (Step 10) triggers refinement loops or documented closure. # Step number ok

## 9. PAL Validation Record ðŸ§ª

*   Date Validated: TBD
*   Method: TBD (Test Case Execution)
*   Test Case(s): Enrich existing mode 'X' using Context7 URL 'Y'. Verify KB files, `_index.json`, `source_info.json` (including attempted metadata), summary rule, README, usage strategy, and mode definition. # Updated test case
*   Findings/Refinements: TBD

## 10. Revision History ðŸ“œ

*   v1.8 (2025-04-27): Updated Step 2 logic: Prioritize MCPs, then manual input for metadata. Added fallback: if fetching/input fails or user skips, default `tokens` to 10,000,000 and set other metadata to `null`. Updated related notes, checks, postconditions, error handling, and PAL test case. Updated version and date in TOML.
*   v1.7 (2025-04-27): Added fallback value (`10000000`) for `--tokens` argument in Step 3.2 if metadata fetch in Step 2 fails to retrieve a token count. Updated Coordinator Note. Updated version and date in TOML.
*   v1.6 (2025-04-27): Reordered steps: Fetch Metadata (now Step 2) before Execute Script (now Step 3) to allow passing fetched token count to the script. Updated script command in Step 3.2 to conditionally include `--tokens`. Renumbered subsequent steps (4-11) and updated internal references throughout. Updated version and date in TOML.
*   v1.5 (2025-04-27): Inserted new Step 3 for fetching source metadata (originalSourceUrl, tokens, snippets, lastUpdated) using MCPs or manual fallback. Updated Step 4 (original Step 3) to incorporate fetched metadata into `source_info.json`. Renumbered subsequent steps (5-11). Updated TOML metadata, scope, roles, criteria, postconditions, error handling, PAL test case, and references throughout.
*   v1.4 (2025-04-27): Added Step 3 to store Context7 `baseUrl` and `llmsJsonUrl` in `kb/context7/source_info.json`. Removed old Step 3 (summary rule creation). Modified README update step (now Step 7) to remove URL mention. Renumbered subsequent steps and updated references. Updated checks, postconditions, and revision history.
*   v1.3 (2025-04-27): Added Step 3 to store Context7 base URL in `kb/context7/source_info.json`. Removed URL mention from README update step (now Step 7). Renumbered subsequent steps and updated references. Added `source_info.json` to related context in summary rule (Step 4) and checks/postconditions.
*   v1.2 (2025-04-27): Added Step 3 to generate a Context7 summary rule file (`.roo/rules-[mode_slug]/05-context7-summary.md`). Renumbered subsequent steps and updated references.
*   v1.1 (2025-04-27): Removed outdated references to master `index.toml`. Workflow now relies solely on the script-generated `_index.json` within the `context7` directory and updates README accordingly. Renumbered steps after removing Step 3.
*   v1.0 (2025-04-27): Initial version created by extracting Context7 logic from WF-MODE-KB-ENRICHMENT-002 (v2.2). Relies on `process_llms_json.js` script.